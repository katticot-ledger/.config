# ===============================
# 🚀 Tmux Configuration File 🚀
# ===============================

# ======================
# 🔧 General Settings
# ======================
set -g mouse on                                        # 🖱️ Enable mouse support
set -g base-index 1                                    # 🔢 Start windows at index 1
set -g pane-base-index 1                              # 🔢 Start panes at index 1
set-window-option -g pane-base-index 1                # 🔢 Start panes at index 1
set-option -g renumber-windows on                     # 🔄 Renumber windows automatically
set-option -g default-shell /opt/homebrew/bin/fish    # 🐟 Set fish shell

# ======================
# 🎨 Theme & Appearance
# ======================
# Status bar position and colors
set-option -g status-position top
set-option -g status-justify centre
set-option -g status-bg '#282a36'
set-option -g status-fg '#f8f8f2'

# Status bar content
set -g status-left-length 40
set -g status-left "#[fg=#8be9fd] #[bold]#S #[fg=#f8f8f2]|"
set -g status-right-length 80
set -g status-right "#[fg=#f1fa8c]󰥔 %Y-%m-%d #[fg=#ff79c6] %H:%M #[fg=#50fa7b]✔"

# Window status styling
setw -g window-status-format " #[fg=#bd93f9]󰓩 #I:#W "
setw -g window-status-current-format " #[bold,fg=#ffb86c]󰮯 #I:#W "

# Pane border styling
set-option -g pane-border-style fg='#44475a'
set-option -g pane-active-border-style fg='#ff79c6'

# Message box styling
set-option -g message-style bg='#ff79c6',fg='#f8f8f2'
set-option -g message-command-style bg='#ff79c6',fg='#f8f8f2'

# Terminal overrides for better support
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# ======================
# 🔄 Key Bindings
# ======================
# Unbind default keys
unbind r
unbind f
unbind b
unbind p

# Session switching shortcuts
bind-key b switch-client -t basic     # ⬅️ Switch to 'basic' session
bind-key o switch-client -t obsidian  # 📓 Switch to 'obsidian' session
bind-key p switch-client -t perso     # 👤 Switch to 'perso' session
bind-key f switch-client -t front     # ➡️ Switch to 'front' session

# Configuration reload
bind r source-file ~/.config/tmux/tmux.conf \; display-message "✅ Config reloaded!"

# Window management
bind-key & kill-window                # ❌ Close window without confirmation

# Vim-style pane navigation
bind h select-pane -L                 # ⬅️ Select left pane
bind j select-pane -D                 # ⬇️ Select down pane
bind k select-pane -U                 # ⬆️ Select up pane
bind l select-pane -R                 # ➡️ Select right pane

# Custom pane creation with auto-kill logic
bind C {
    splitw -f -l30% ''
    set-hook -p pane-mode-changed 'if -F "#{!=:#{pane_mode},copy-mode}" "kill-pane"'
    copy-mode -s'{last}'
}

# ======================
# 🔌 Plugin Management
# ======================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'laktak/extrakto'
set -g @plugin 'dracula/tmux'

# ======================
# 🌙 Dracula Theme Config
# ======================
set -g @dracula-show-powerline true
set -g @dracula-plugins "weather"
set -g @dracula-show-fahrenheit false
set -g @dracula-fixed-location "Paris"
set -g @dracula-day-month true
set -g @dracula-show-flags true
set -g @dracula-show-left-icon session

# ======================
# 💾 Session Persistence
# ======================
set -g @continuum-restore 'on'
set -g @resurrect-dir '~/.config/tmux/resurrect'

# ======================
# 🚀 Initialize TPM
# ======================
run-shell "$HOME/.config/tmux/plugins/tpm/tpm"